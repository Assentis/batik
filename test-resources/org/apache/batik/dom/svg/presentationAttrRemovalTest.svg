<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN"
"http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">

<!-- ========================================================================= -->
<!-- Copyright (C) The Apache Software Foundation. All rights reserved.        -->
<!--                                                                           -->
<!-- This software is published under the terms of the Apache Software License -->
<!-- version 1.1, a copy of which has been included with this distribution in  -->
<!-- the LICENSE file.                                                         -->
<!-- ========================================================================= -->

<!-- ========================================================================= -->
<!-- This test checks that the various RGB values read from the SVGColor       -->
<!-- interface return accurate values.                                         -->
<!--                                                                           -->
<!-- @author shillion@ilog.fr                                                  -->
<!-- @version $Id$            -->
<!-- ========================================================================= -->

<svg xmlns="http://www.w3.org/2000/svg" 
     xmlns:xlink="http://www.w3.org/1999/xlink" 
     xmlns:test="http://xml.apache.org/batik/test"
     width="450" height="500" viewBox="0 0 450 500"
     onload="runTest(evt)">

  <test:testResult id="testResult" />

  <script type="text/ecmascript"><![CDATA[
     var testNS = "http://xml.apache.org/batik/test";

     function runTest() {
         var result = document.getElementById("testResult");
         result.setAttributeNS(null, "result", "failed");
        
         var r1 = document.getElementById("r1")
         if (r1 == null){
          result.setAttributeNS(null, "errorCode", "cannot.find.test.element");
          var entry = document.createElementNS(testNS, "errorDescriptionEntry");
          entry.setAttributeNS(null, "id", "missing.element.id");
          entry.setAttributeNS(null, "value", "r1");
          result.appendChild(entry);
          return;
         }

         var compStyle = document.documentElement.getComputedStyle(r1, null);         
         if (compStyle.getPropertyValue("fill") != "rgb(0, 255, 0)") {
           result.setAttributeNS(null, "errorCode", "wrong.computed.style");
           var entry = document.createElementNS(testNS, "errorDescriptionEntry");
           entry.setAttributeNS(null, "value", "invalid.value");
           entry.setAttributeNS(null, "value", compStyle.getPropertyValue("fill"));
           result.appendChild(entry);
           return;
         }

         r1.removeAttributeNS(null, "fill");

         if (compStyle.getPropertyValue("fill") != "rgb(255, 0, 0)") {
           result.setAttributeNS(null, "errorCode", "wrong.computed.style");
           var entry = document.createElementNS(testNS, "errorDescriptionEntry");
           entry.setAttributeNS(null, "value", "invalid.value");
           entry.setAttributeNS(null, "value", compStyle.getPropertyValue("fill"));
           result.appendChild(entry);
           return;
         }

         result.setAttributeNS(null, "result", "passed");
     }
  ]]></script>

  <g fill="rgb(255, 0, 0)">
     <rect id="r1" x="0" y="0" width="100" height="100" fill="rgb(0, 255, 0)"/>
     <rect id="r2" x="20" y="20" width="100" height="100"/>
  </g>
</svg>
