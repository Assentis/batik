<!--                                                             -->
<!--         Ant project file for the Batik project              -->
<!--         ______________________________________              -->
<!--                                                             -->
<!--                          by                                 -->
<!--                                                             -->
<!--           Stephane Hillion and Thierry Kormann              -->
<!--                                                             -->

<project default="build" basedir=".">
  <!-- The main target: build the distribution -->
  <target name="build" depends="compile, javadoc"/>

  <!-- Initialization target -->
  <target name="init">
    <tstamp/>
    <property name="project"       value="batik"/>
    <property name="jdoc"          value="docs/javadoc"/>
    <property name="src"           value="sources"/>
    <property name="dest"          value="classes"/>
    <property name="res"           value="resources"/>
    <property name="class-prefix"  value="org.apache.${project}"/>
    <property name="source-prefix" value="org/apache/${project}"/>
    <property name="packages"      value="
		      ${class-prefix}.apps.domviewer,
		      ${class-prefix}.apps.svgviewer,
		      ${class-prefix}.bridge,
		      ${class-prefix}.css,
		      ${class-prefix}.css.event,
		      ${class-prefix}.css.sac,
		      ${class-prefix}.css.svg,
		      ${class-prefix}.css.value,
		      ${class-prefix}.dom,
		      ${class-prefix}.dom.events,
		      ${class-prefix}.dom.svg,
		      ${class-prefix}.dom.util,
		      ${class-prefix}.gvt,
		      ${class-prefix}.gvt.event,
		      ${class-prefix}.gvt.filter,
		      ${class-prefix}.gvt.renderer,
		      ${class-prefix}.gvt.text,
		      ${class-prefix}.i18n,
		      ${class-prefix}.parser,
		      ${class-prefix}.parser.style,
		      ${class-prefix}.script,
		      ${class-prefix}.script.test,
		      ${class-prefix}.transcoder,
		      ${class-prefix}.util,
		      ${class-prefix}.util.gui"/>
    <property name="packages-ext"  value="
			org.w3c.css.sac,
			org.w3c.css.sac.helpers,
			org.w3c.dom,
			org.w3c.dom.css,
			org.w3c.dom.events,
			org.w3c.dom.smil,
			org.w3c.dom.stylesheets,
			org.w3c.dom.svg,
			org.w3c.dom.views,
			org.xml.sax,
			org.xml.sax.ext,
			org.xml.sax.helpers"/>
    <property name="packages-refimpl" value="
			  ${class-prefix}.refimpl.bridge,
			  ${class-prefix}.refimpl.gvt,
			  ${class-prefix}.refimpl.gvt.event,
			  ${class-prefix}.refimpl.gvt.filter,
			  ${class-prefix}.refimpl.gvt.renderer,
			  ${class-prefix}.refimpl.gvt.text,
			  ${class-prefix}.refimpl.parser,
			  ${class-prefix}.refimpl.script,
			  ${class-prefix}.refimpl.script.jacl,
			  ${class-prefix}.refimpl.script.jpython,
			  ${class-prefix}.refimpl.script.rhino,
			  ${class-prefix}.refimpl.util"/>
    <property name="packages-all"  value="${packages}, 
                                          ${packages-refimpl},
			                  ${packages-ext}"/>
  </target>


  <!-- Help on usage -->
  <target name="usage">
    <echo message=""/>
    <echo message=""/>
    <echo message="Batik Build file"/>
    <echo message="-------------------------------------------------------------"/>
    <echo message=""/>
    <echo message=" available targets are:"/>
    <echo message=""/>
    <echo message="   compile      --> compiles the source code"/>
    <echo message="   javadoc      --> generates the API documentation"/>
    <echo message="   clean        --> cleans up the directory"/>
    <echo message=""/>
    <echo message=" See the comments inside the build.xml file for more details."/>
    <echo message="-------------------------------------------------------------"/>
    <echo message=""/>
    <echo message=""/>
  </target>

  <!-- Creates the jar file which contains all the classes -->
  <target name="classes-jar" depends="compile">
    <jar jarfile="${project}.jar" basedir="${dest}" includes="**"
         excludes="**/test"/>
  </target>

  <!-- Cleans the jar file that contains the classes -->
  <target name="clean-classes-jar" depends="init">
      <delete file="${project}.jar"/>
  </target>

  <!-- Creates the jar file which contains all the resources -->
  <target name="resources-jar" depends="init">
    <jar jarfile="${project}-resources.jar" basedir="${res}" includes="**"/>
  </target>

  <!-- Cleans the jar file which contains the resources -->
  <target name="clean-resources-jar" depends="init">
      <delete file="${project}-resources.jar"/>
  </target>

  <!-- Compiles the source files to the ${dest} directory -->
  <target name="compile" depends="init">
    <mkdir dir="${dest}"/>
    <javac classpath="lib/js.jar:lib/jpython.jar:lib/jacl.jar:lib/tcljava.jar" srcdir="${src}"
           destdir="${dest}"
           includes="**/*.java"/>
  </target>

  <!-- Cleans the files generated by a compilation -->
  <target name="clean-compile" depends="init">
      <deltree dir="${dest}"/>
  </target>

  <!-- Generates the javadoc for all the source files -->
  <target name="javadoc">
    <mkdir dir="${jdoc}"/>
    <javadoc packagenames="${packages-all}"
             sourcepath="${src}"
             destdir="${jdoc}"
             author="false"
             version="false"/>
  </target>

  <!-- Cleans the files generated by javadoc -->
  <target name="clean-javadoc" depends="init">
      <deltree dir="${jdoc}"/>
  </target>

  <!-- Creates the jar file that contains the interfaces -->
  <target name="jar-int" depends="compile">
    <jar jarfile="batik-int.jar" basedir="resources"
         includes="org/apache/batik/bridge/**,
                   org/apache/batik/gvt/**,
                   org/apache/batik/parser/**,
                   org/apache/batik/script/**,
                   org/apache/batik/util/**,
                   org/apache/batik/i18n/**"/>
  </target>

  <!-- Cleans the files generated by jar-batik -->
  <target name="clean-jar-int" depends="init">
      <delete file="batik-int.jar"/>
  </target>

  <!-- Creates the jar file that contains the reference implementation -->
  <target name="jar-refimpl" depends="compile">
    <jar jarfile="batik-refimpl.jar" basedir="${dest}"
         includes="org/apache/batik/refimpl/**"/>
  </target>

  <!-- Cleans the files generated by jar-batik -->
  <target name="clean-jar-refimpl" depends="init">
      <delete file="batik-refimpl.jar"/>
  </target>

  <!-- Creates the jar file that contains everything -->
  <target name="jar-all" depends="jar-res">
    <jar jarfile="batik-all.jar" basedir="${dest}"
         includes="**"/>
  </target>

  <!-- Cleans the files generated by jar-all -->
  <target name="clean-jar-all" depends="clean-jar-res">
      <delete file="batik-all.jar"/>
  </target>

  <!-- Creates the jar file that contains the applications -->
  <target name="jar-apps" depends="compile">
    <jar jarfile="batik-apps.jar" basedir="${dest}"
         includes="org/apache/batik/apps/**"/>
  </target>

  <!-- Cleans the files generated by jar-batik -->
  <target name="clean-jar-apps" depends="init">
      <delete file="batik-apps.jar"/>
  </target>

  <!-- Creates the jar file that contains the resources -->
  <target name="jar-res" depends="compile">
    <jar jarfile="batik-res.jar" basedir="resources"
         includes="**"/>
  </target>

  <!-- Cleans the files generated by jar-res -->
  <target name="clean-jar-res" depends="init">
      <delete file="batik-res.jar"/>
  </target>

  <!-- Creates the jar file that contains the DOM classes -->
  <target name="jar-dom" depends="compile">
    <jar jarfile="batik-dom.jar" basedir="${dest}"
         includes="org/apache/batik/dom/**, org/apache/batik/css/**"/>
  </target>

  <!-- Cleans the files generated by jar-dom -->
  <target name="clean-jar-dom" depends="init">
      <delete file="batik-dom.jar"/>
  </target>

  <!-- Creates the jar file that contains the W3C classes -->
  <target name="jar-w3c" depends="compile">
    <jar jarfile="batik-w3c.jar" basedir="${dest}" includes="org/w3c/**"/>
  </target>

  <!-- Cleans the files generated by jar-w3c -->
  <target name="clean-jar-w3c" depends="init">
      <delete file="batik-w3c.jar"/>
  </target>

  <!-- Cleans everything -->
  <target name="clean" depends="clean-compile, 
                                clean-javadoc, 
                                clean-jar-all,
                                clean-jar-apps,
                                clean-jar-dom,
                                clean-jar-w3c,
                                clean-jar-res"/>

</project>
